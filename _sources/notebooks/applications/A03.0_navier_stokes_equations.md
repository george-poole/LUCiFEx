# Navier-Stokes equations

## Nonlinear equations

strong form

$$
\begin{align*}
&\text{Find}~\textbf{u}(\textbf{x}, t): \Omega\times[0, \infty) \to \mathbb{R}^d~\text{and}~p(\textbf{x}, t): \Omega\times[0, \infty) \to \mathbb{R}~\text{such that} \\
&\begin{cases}
\nabla\cdot\textbf{u} = 0 & \\
\rho \left(\frac{\partial\textbf{u}}{\partial t}+\textbf{u}\cdot\nabla\textbf{u}\right)=-\nabla p + \nabla\cdot\tau(\textbf{u}) + \textbf{f}(\textbf{x}, t) & \forall(\textbf{x}, t)\in\Omega\times[0,\infty) \\
\textbf{u}(\textbf{x},t=0)=\textbf{u}_0 & \forall\textbf{x}\in\Omega \\
p(\textbf{x},t=0)=p_0 & \forall\textbf{x}\in\Omega \\
\textbf{u} = \textbf{u}_{\text{E}} & \forall \textbf{x}\in\partial\Omega_{\text{E}} \times[0, \infty) \\
(-p\mathsf{I}+\tau)\cdot\textbf{n} = \boldsymbol{\tau}_{\text{N}} & \forall(\textbf{x},t)\in\partial\Omega_{\text{N}}\times[0, \infty)~,~\partial\Omega_{\text{N}}=\partial\Omega/\partial\Omega_{\text{E}}
\end{cases}~.
\end{align*}
$$

weak form 
$$
\begin{align*}
&\text{Find}~(\textbf{u}, p)\in V_{\textbf{u}} \times V_p~\text{such that} \\
&F(\textbf{u}, p;\textbf{v}, q)=\dots \\
&=0 \quad\forall(\textbf{v}, q)\in V_{\textbf{u}} \times V_p~.
\end{align*}
$$


## Linearization schemes

### Incremental pressure correction scheme (IPCS)

sequence of weak forms
$$
\begin{align*}
&\text{Find}~\widetilde{\textbf{u}}^{n+1}\in V_{\textbf{u}}~\text{such that} \\
&\begin{align*}
F_1(\widetilde{\textbf{u}}^{n+1}, \textbf{v}) &= 
\int_\Omega\text{d}\Omega~\rho\textbf{v}\cdot\frac{\widetilde{\textbf{u}}^{n+1}-\textbf{u}^n}{\Delta t^n} + \rho \textbf{v}\cdot\mathcal{D}_{\textbf{u}}(\textbf{u}\cdot\nabla\textbf{u}) \\
&\qquad\quad +\varepsilon(\textbf{v}):(-p^n\mathsf{I} + \mathcal{D}_\tau(\boldsymbol{\tau})) -\textbf{v}\cdot\mathcal{D}_{\textbf{f}}(\textbf{f}) \\ 
&\quad -\int_{\partial\Omega}\text{d}\Gamma~\textbf{v}\cdot(-p^n\mathsf{I} + \mathcal{D}_\tau(\boldsymbol{\tau}))\cdot\textbf{n} \\
&=0 \quad\forall \textbf{v} \in V_{\textbf{u}}~. \\
\end{align*} \\
&\text{Find}~p^{n+1}\in V_p~\text{such that} \\
&F_2(p^{n+1}, q) = \int_\Omega\text{d}\Omega~\nabla q\cdot\nabla p^{n+1} - \nabla q\cdot\nabla p^n + q\rho\frac{\nabla\cdot\widetilde{\textbf{u}}^{n+1}}{\Delta t^n} =0 \quad\forall q\in V_p~. \\
\\
&\text{Find}~\textbf{u}^{n+1}\in V_{\textbf{u}}~\text{such that} \\
&F_3(\textbf{u}^{n+1}, \textbf{v}) = \int_\Omega\text{d}\Omega~\textbf{v}\cdot\rho\frac{\textbf{u}^{n+1}-\widetilde{\textbf{u}}^{n+1}}{\Delta t^n} + \textbf{v}\cdot\nabla p^{n+1} - \textbf{v}\cdot\nabla p^n = 0 \quad\forall \textbf{v} \in V_{\textbf{u}}~. \\
\end{align*}
$$

### Chorin's scheme

sequence of weak forms
$$
\begin{align*}
&\text{Find}~\widetilde{\textbf{u}}^{n+1}\in V_{\textbf{u}}~\text{such that} \\
&F_1(\widetilde{\textbf{u}}^{n+1}, \textbf{v}) = \int_\Omega\text{d}\Omega~\textbf{v}\cdot\frac{\widetilde{\textbf{u}}^{n+1}-\textbf{u}^n}{\Delta t^n} + \textbf{v}\cdot\mathcal{D}_{\textbf{u}}(\textbf{u}\cdot\nabla\textbf{u}) + \nabla\textbf{v}\cdot\nabla\mathcal{D}_{\tau}(\boldsymbol{\tau}) -\textbf{v}\cdot\mathcal{D}_{\textbf{f}}(\textbf{f}) =0 \quad\forall \textbf{v} \in V_{\textbf{u}}~. \\
\\
&\text{Find}~p^{n+1}\in V_p~\text{such that} \\
&F_2(p^{n+1}, q) = \int_\Omega\text{d}\Omega~\nabla q\cdot\nabla p^{n+1} + q\rho\frac{\nabla\cdot\widetilde{\textbf{u}}^{n+1}}{\Delta t^n} =0 \quad\forall q\in V_p~. \\
\\
&\text{Find}~\textbf{u}^{n+1}\in V_{\textbf{u}}~\text{such that} \\
&F_3(\textbf{u}^{n+1}, \textbf{v}) = \int_\Omega\text{d}\Omega~\textbf{v}\cdot\rho\frac{\textbf{u}^{n+1}-\widetilde{\textbf{u}}^{n+1}}{\Delta t^n} + \textbf{v}\cdot\nabla p^{n+1}
\end{align*}
$$

## Streamfunction-vorticity formulation

### General definitions
$$\textbf{u}=\nabla\times\boldsymbol{\psi} \iff \nabla\cdot\textbf{u}=0$$
$$\boldsymbol{\omega}=\nabla\times\textbf{u}=\nabla\times(\nabla\times\boldsymbol{\psi})$$

Newtonian stress and constant $\rho$, $\mu$
$$\tau(\textbf{u}) = \frac{\mu}{2}\left(\nabla\textbf{u} + \nabla\textbf{u}^{\mathsf{T}}\right)$$

$$\implies\rho\left(\frac{\partial\boldsymbol{\omega}}{\partial t}+(\nabla\times\boldsymbol{\psi})\cdot\nabla\boldsymbol{\omega} - \boldsymbol{\omega}\cdot\nabla(\nabla\times\boldsymbol{\psi})\right)=\mu\nabla^2\boldsymbol{\omega} + \nabla\times\textbf{f}$$

### Cartesian streamfunction-vorticity in 2D

$$\boldsymbol{\psi}=\psi\textbf{e}_z\implies\textbf{u}=\frac{\partial\psi}{\partial y}\textbf{e}_x - \frac{\partial\psi}{\partial x}\textbf{e}_y$$

$$\boldsymbol{\omega}=\omega\textbf{e}_z=\left(\frac{\partial u_y}{\partial x} - \frac{\partial u_x}{\partial y}\right)\textbf{e}_z$$

$$\textbf{f}=f_x\textbf{e}_x + f_y\textbf{e}_y$$

strong form
$$
\begin{align*}
&\text{Find}~\psi(\textbf{x}, t): \Omega\times[0, \infty) \to \mathbb{R}~\text{and}~\omega(\textbf{x}, t): \Omega\times[0, \infty) \to \mathbb{R}~\text{such that} \\
&\begin{cases}
\nabla^2\psi =\omega & \\
\rho\left(\frac{\partial\omega}{\partial t}+\left(-\frac{\partial\psi}{\partial y}, \frac{\partial\psi}{\partial x}\right)\cdot\nabla\omega\right) =\mu\nabla^2\omega + \frac{\partial f_y}{\partial x} - \frac{\partial f_x}{\partial y} & \forall(\textbf{x}, t)\in\Omega\times[0,\infty) \\
\omega(\textbf{x}, t=0)=\omega_0 & \forall \textbf{x}\in\Omega \\
\psi=\psi_{\text{D}} & \forall \textbf{x}\in\partial\Omega_{\text{D}, \psi} \times [0,\infty] \\
\textbf{n}\cdot\nabla\psi = \psi_{\text{N}} & \forall\textbf{x}\in\partial\Omega_{\text{N}, \psi}
\times [0,\infty]~,~\partial\Omega_{\text{N}, \psi}=\partial\Omega/\partial\Omega_{\text{D}, \psi} \\
\omega=\omega_{\text{D}} & \forall \textbf{x}\in\partial\Omega_{\text{D},\omega} \times [0,\infty] \\
\textbf{n}\cdot\nabla\omega = \omega_{\text{N}} & \forall\textbf{x}\in\partial\Omega_{\text{N},\omega}\times[0,\infty]~,~\partial\Omega_{\text{N},\omega}=\partial\Omega/\partial\Omega_{\text{D},\omega} 
\end{cases}~.
\end{align*}
$$