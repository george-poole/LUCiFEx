# Stokes equations

## Mixed formulation

boundary value problem on $\textbf{x}\in\Omega$

$$\nabla\cdot\textbf{u} = 0$$
$$\textbf{0}=\nabla\cdot\sigma + \textbf{f}$$

constitutive relation

$$\sigma=\sigma(\textbf{u}, p)$$

essential boundary condition on $\textbf{x}\in\partial\Omega_{\text{E}}$

$$\textbf{u} = \textbf{u}_{\text{E}}$$

natural boundary condition on $\textbf{x}\in\partial\Omega_{\text{N}}=/\partial\Omega_{\text{E}}$

$$\sigma\cdot\textbf{n} = \boldsymbol{\sigma}_{\text{N}}$$

Note that if $\textbf{n}\cdot\nabla\textbf{u}\vert_{\partial\Omega_{\text{N}}}=\textbf{0}$ (i.e. the velocity gradient in the normal direction is constant) then the natural bounday condition is in effect a prescribed pressure.

variational formulation $\forall(\textbf{v}, q)\in V_{\textbf{u}} \times V_p$

$$F(\textbf{u}, p;\textbf{v}, q)=\int_\Omega\text{d}\Omega~q(\nabla\cdot\textbf{u}) + \nabla\textbf{v}:\sigma - \textbf{v}\cdot\textbf{f} - \int_{\partial\Omega_{\text{N}}}\text{d}\Gamma~\,\textbf{v}\cdot\boldsymbol{\sigma}_{\text{N}}=0$$

$$\sigma(\textbf{u}, p) = -p\,\mathsf{I} + \mu(\nabla\textbf{u} + \nabla\textbf{u}^{\mathsf{T}})\implies \nabla\textbf{v}:\sigma \to - p(\nabla\cdot\textbf{v}) + \mu\nabla\textbf{v}\cdot\nabla\textbf{u}$$

## Streamfunction formulation

Newtonian constitutive relation

$$\sigma(\textbf{u}, p) = -p\,\mathsf{I} + \nabla\textbf{u} + \nabla\textbf{u}^{\mathsf{T}}$$

$$\textbf{u}=\nabla\times\boldsymbol{\psi} \iff \nabla\cdot\textbf{u}=0$$

$$\implies\textbf{0}=\nabla^2(\nabla\times\boldsymbol{\psi}) + \nabla\times\textbf{f}$$

$d=2$ Cartesian formulation

$$\textbf{u}=\nabla\times\psi\textbf{e}_z=-\frac{\partial\psi}{\partial y}\textbf{e}_x + \frac{\partial\psi}{\partial x}\textbf{e}_y$$

$$\textbf{f}=f_x\textbf{e}_x + f_y\textbf{e}_y$$

$$\implies\nabla^2(\nabla^2\psi) = \frac{\partial f_y}{\partial x}- \frac{\partial f_x}{\partial y}$$

boundary conditions on $\textbf{x}\in\partial\Omega$ with unit normal $\textbf{n}\in\{\pm\textbf{e}_x, \pm\textbf{e}_y\}$ and unit tangent $\textbf{t}\in\{\pm\textbf{e}_y, \pm\textbf{e}_x\}$

$$\textbf{n}\cdot\textbf{u}\vert_{\partial\Omega}=0 \implies \psi\vert_{\partial\Omega}=0$$

$$\textbf{n}\cdot\nabla(\textbf{t}\cdot\textbf{u})\vert_{\partial\Omega}=0 \implies \nabla^2\psi\vert_{\partial\Omega}=0$$

variational formulation with penalty parameter $\alpha$ and local mesh cell size $\ell(\textbf{x})$

$$F(\psi, v) = \int_\Omega\text{d}\Omega~\nabla^2v \nabla^2u - v\frac{\partial f_y}{\partial x} + v\frac{\partial f_x}{\partial y} + \int_{\mathcal{F}}\text{d}\Gamma~\frac{\alpha}{\ell(\textbf{x})}\llbracket\nabla v\rrbracket\llbracket\nabla u\rrbracket - \llbracket\nabla v\rrbracket\langle\nabla^2u\rangle - \langle\nabla^2v\rangle\llbracket\nabla u\rrbracket$$