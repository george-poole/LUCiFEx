# Navier-Stokes equations

## Nonlinear equations

strong form of the initial boundary value problem
$$
\begin{align*}
&\text{Find $\textbf{u}(\textbf{x}, t): \Omega\times[0, \infty) \to \mathbb{R}^d$ and $p(\textbf{x}, t): \Omega\times[0, \infty) \to \mathbb{R}$ such that } \\
&\begin{cases}
\nabla\cdot\textbf{u} = 0 & \\
\rho \left(\frac{\partial\textbf{u}}{\partial t}+\textbf{u}\cdot\nabla\textbf{u}\right)=-\nabla p + \nabla\cdot\tau(\textbf{u}) + \textbf{f}(\textbf{x}, t) & \forall(\textbf{x}, t)\in\Omega\times[0,\infty) \\
\textbf{u}(\textbf{x},t=0)=\textbf{u}_0 & \forall\textbf{x}\in\Omega \\
p(\textbf{x},t=0)=p_0 & \forall\textbf{x}\in\Omega \\
\textbf{u} = \textbf{u}_{\text{E}} & \forall \textbf{x}\in\partial\Omega_{\text{E}} \times[0, \infty) \\
(-p\mathsf{I}+\tau)\cdot\textbf{n} = \boldsymbol{\tau}_{\text{N}} & \forall(\textbf{x},t)\in\partial\Omega_{\text{N}}\times[0, \infty)~,~\partial\Omega_{\text{N}}=\partial\Omega/\partial\Omega_{\text{E}}
\end{cases}~.
\end{align*}
$$

weak form 
$$
\begin{align*}
&\text{Find $(\textbf{u}, p)\in V_{\textbf{u}} \times V_p$ such that } \\
&F(\textbf{u}, p;\textbf{v}, q)=\dots \\
&=0 \quad\forall(\textbf{v}, q)\in V_{\textbf{u}} \times V_p~.
\end{align*}
$$


## Linearization schemes

### Incremental pressure correction scheme (IPCS)

time discretization

$$\rho \frac{\widetilde{\textbf{u}}^{n+1}- \textbf{u}^n}{\Delta t^n}+\rho \mathcal{D}_{\textbf{u}}(\textbf{u}\cdot\nabla\textbf{u})=\nabla\cdot\sigma(\mathcal{D}_\sigma(\textbf{u}), p^n) + \mathcal{D}_{\textbf{f}}(\textbf{f})$$

$$-\rho\frac{\nabla\cdot\widetilde{\textbf{u}}^{n+1}}{\Delta t^n}=\nabla^2 p^n - \nabla^2p^{n+1}$$

$$\rho\frac{\textbf{u}^{n+1}-\widetilde{\textbf{u}}^{n+1}}{\Delta t^n}=\nabla p^n - \nabla p^{n+1}$$

$$\mathcal{D}_{\textbf{u}}=\text{FE}~,~\mathcal{D}_{\sigma}=\text{CN}~,~\mathcal{D}_{\textbf{f}}=\text{BE}$$

weak forms
$$
\begin{align*}
&\text{Find $\widetilde{\textbf{u}}^{n+1}\in V_{\textbf{u}}$ such that } \\
&F_1(\widetilde{\textbf{u}}^{n+1}, \textbf{v}) = \int_\Omega\text{d}\Omega~\rho\textbf{v}\cdot\frac{\widetilde{\textbf{u}}^{n+1}-\textbf{u}^n}{\Delta t^n} + \rho \textbf{v}\cdot\mathcal{D}_{\textbf{u}}(\textbf{u}\cdot\nabla\textbf{u}) + \varepsilon(\textbf{v}):\sigma(\mathcal{D}_\sigma(\textbf{u}), p^n) -\textbf{v}\cdot\mathcal{D}_{\textbf{f}}(\textbf{f}) \\ 
&-\int_{\partial\Omega}\textbf{v}\cdot(\sigma(\mathcal{D}_\sigma(\textbf{u}), p^n)\cdot\textbf{n}) \\
&=0 \quad\forall \textbf{v} \in V_{\textbf{u}}~. \\
\\
&\text{Find $p^{n+1}\in V_p$ such that } \\
&F_2(p^{n+1}, q) = \int_\Omega\text{d}\Omega~\nabla q\cdot\nabla p^{n+1} - \nabla q\cdot\nabla p^n + q\rho\frac{\nabla\cdot\widetilde{\textbf{u}}^{n+1}}{\Delta t^n} =0 \quad\forall q\in V_p~. \\
\\
&\text{Find $\textbf{u}^{n+1}\in V_{\textbf{u}}$ such that } \\
&F_3(\textbf{u}^{n+1}, \textbf{v}) = \int_\Omega\text{d}\Omega~\textbf{v}\cdot\rho\frac{\textbf{u}^{n+1}-\widetilde{\textbf{u}}^{n+1}}{\Delta t^n} + \textbf{v}\cdot\nabla p^{n+1} - \textbf{v}\cdot\nabla p^n
\end{align*}
$$

### Chorin's scheme

Newtonian constitutive relation

$$\varepsilon(\textbf{u})=\tfrac{1}{2}(\nabla\textbf{u} + (\nabla\textbf{u})^{\mathsf{T}})$$

$$\sigma(\textbf{u}, p) = -p\,\mathsf{I} + 2\mu\varepsilon(\textbf{u})$$

$$\implies \nabla\cdot\sigma=-\nabla p + \mu\nabla^2\textbf{u}$$

time discretization

$$\rho \frac{\widetilde{\textbf{u}}^{n+1}-\rho \textbf{u}^n}{\Delta t^n}+\mathcal{D}_{\textbf{u}}(\textbf{u}\cdot\nabla\textbf{u})= \mu\nabla^2\mathcal{D}_\sigma(\textbf{u}) + \mathcal{D}_{\textbf{f}}(\textbf{f})$$

$$\rho\frac{\nabla\cdot\widetilde{\textbf{u}}^{n+1}}{\Delta t^n} = \nabla^2p^{n+1}$$

$$\rho\frac{\textbf{u}^{n+1}-\widetilde{\textbf{u}}^{n+1}}{\Delta t^n}= - \nabla p^{n+1}$$

$$\mathcal{D}_{\textbf{u}}=\text{FE}~,~\mathcal{D}_{\sigma}=\text{FE}~,~\mathcal{D}_{\textbf{f}}=\text{BE}$$

variational formulation $\forall(\textbf{v}, q)\in V_{\textbf{u}} \times V_p$

$$F_1(\widetilde{\textbf{u}}^{n+1}, \textbf{v}) = \int_\Omega\text{d}\Omega~\textbf{v}\cdot\frac{\widetilde{\textbf{u}}^{n+1}-\textbf{u}^n}{\Delta t^n} + \textbf{v}\cdot\mathcal{D}_{\textbf{u}}(\textbf{u}\cdot\nabla\textbf{u}) + \mu\nabla\textbf{v}\cdot\nabla\mathcal{D}_{\sigma}(\textbf{u}) -\textbf{v}\cdot\mathcal{D}_{\textbf{f}}(\textbf{f})$$

$$F_2(p^{n+1}, q) = \int_\Omega\text{d}\Omega~\nabla q\cdot\nabla p^{n+1} + q\rho\frac{\nabla\cdot\widetilde{\textbf{u}}^{n+1}}{\Delta t^n} $$

$$F_3(u^{n+1}, \textbf{v}) = \int_\Omega\text{d}\Omega~\textbf{v}\cdot\rho\frac{\textbf{u}^{n+1}-\widetilde{\textbf{u}}^{n+1}}{\Delta t^n} + \textbf{v}\cdot\nabla p^{n+1}$$

## Streamfunction-vorticity formulation

streamfunction-vorticity formulation with constant $\rho$ and $\mu$

$$\textbf{u}=\nabla\times\boldsymbol{\psi} \iff \nabla\cdot\textbf{u}=0$$

$$\boldsymbol{\omega}=\nabla\times\textbf{u}=\nabla\times(\nabla\times\boldsymbol{\psi})$$

$$\implies\rho\left(\frac{\partial\boldsymbol{\omega}}{\partial t}+(\nabla\times\boldsymbol{\psi})\cdot\nabla\boldsymbol{\omega} - \boldsymbol{\omega}\cdot\nabla(\nabla\times\boldsymbol{\psi})\right)=\mu\nabla^2\boldsymbol{\omega} + \nabla\times\textbf{f}$$

$d=2$ Cartesian formulation

$$\boldsymbol{\psi}=\psi\textbf{e}_z\implies\textbf{u}=\frac{\partial\psi}{\partial y}\textbf{e}_x - \frac{\partial\psi}{\partial x}\textbf{e}_y$$

$$\boldsymbol{\omega}=\omega\textbf{e}_z=\left(\frac{\partial u_y}{\partial x} - \frac{\partial u_x}{\partial y}\right)\textbf{e}_z$$

$$\textbf{f}=f_x\textbf{e}_x + f_y\textbf{e}_y$$

$$\implies\qquad
\begin{align*}
\nabla^2\psi &=\omega \\
\rho\left(\frac{\partial\omega}{\partial t}+\left(-\frac{\partial\psi}{\partial y}, \frac{\partial\psi}{\partial x}\right)\cdot\nabla\omega\right) &=\mu\nabla^2\omega + \frac{\partial f_y}{\partial x} - \frac{\partial f_x}{\partial y}
\end{align*}
$$

initial conditions

$$\omega(\textbf{x}, t=0)=\omega_0(\textbf{x})$$

boundary conditions on $\textbf{x}\in\partial\Omega$ with unit normal $\textbf{n}\in\{\pm\textbf{e}_x, \pm\textbf{e}_y\}$ and unit tangent $\textbf{t}\in\{\pm\textbf{e}_y, \pm\textbf{e}_x\}$

$$\textbf{n}\cdot\textbf{u}\vert_{\partial\Omega}=0 \implies \psi\vert_{\partial\Omega}=0$$

$$\textbf{n}\cdot\nabla(\textbf{t}\cdot\textbf{u})\vert_{\partial\Omega}=0 \implies \omega\vert_{\partial\Omega}=0$$