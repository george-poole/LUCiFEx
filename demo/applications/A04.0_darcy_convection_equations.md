# Governing equations for the convection of a Darcy fluid in a porous medium

## Dimensional equations

initial-boundary value problem on $(\textbf{x}, t)\in\Omega\times[0,\infty)$

$$\phi\frac{\partial c}{\partial t} + \textbf{u}\cdot\nabla c = \nabla\cdot(\mathsf{D}\cdot\nabla c) + R$$

$$\phi\frac{\partial\theta}{\partial t} + \textbf{u}\cdot\nabla\theta = \nabla\cdot(\mathsf{G}\cdot\nabla\theta) + Q$$

$$\nabla\cdot\textbf{u}=0$$

$$\textbf{u}=-\frac{\mathsf{K}}{\mu}\cdot(\nabla p + \rho g\,\textbf{e}_g)$$

constitutive relations

$$
\begin{align*}
\phi & =\phi(\textbf{x}) \\
\mathsf{D} &= \mathsf{D}(\phi, \textbf{u}) \\ 
\mathsf{G} &= \mathsf{G}(\phi, \textbf{u}) \\ 
\mathsf{K} &= \mathsf{K}(\phi) \\ 
\mu &= \mu(c, \theta) \\
\rho &= \rho(c, \theta) \\
R & = R(c, \theta, \phi) \\
Q & = Q(c, \theta, \phi)
\end{align*}
$$

initial conditions

$$c(\textbf{x},t=0)=c_0(\textbf{x})$$
$$\theta(\textbf{x},t=0)=\theta_0(\textbf{x})$$

concentration Dirichlet boundary condition on $\textbf{x}\in\partial\Omega_{\text{D},c}$

$$c = c_{\text{D}}$$

concentration Neumann boundary condition on $\textbf{x}\in\partial\Omega_{\text{N},c}=\partial\Omega/\partial\Omega_{\text{D},c}$

$$\textbf{n}\cdot\nabla c = c_{\text{N}}$$

temperature Dirichlet boundary condition on $\textbf{x}\in\partial\Omega_{\text{D}, \theta}$

$$\theta = \theta_{\text{D}}$$

temperature Neumann boundary condition on $\textbf{x}\in\partial\Omega_{\text{N}, \theta}=\partial\Omega/\partial\Omega_{\text{D}, \theta}$

$$\textbf{n}\cdot\nabla\theta = \theta_{\text{N}}$$

essential boundary condition on $\textbf{x}\in\partial\Omega_E$

$$\textbf{n}\cdot\textbf{u} = u_{\text{E}}$$

natural boundary condition on $\textbf{x}\in\partial\Omega_{\text{N}}=\partial\Omega/\partial\Omega_{\text{E}}$

$$p = p_{\text{N}}$$

## Non-dimensionalization

### Scalings

length scale $|\textbf{x}|\sim\mathcal{L}$

velocity scale $|\textbf{u}|\sim\mathcal{U}$

time scale $t\sim\mathcal{T}$

concentration scale $c\sim\Delta c$

temperature scale $\theta\sim\Delta\theta$

buoyancy scale $\rho g\sim g \Delta\rho$

viscosity scale $\mu\sim\mu_{\text{ref}}$

porosity scale $\phi\sim\phi_{\text{ref}}$

permeability scale $K\sim K_{\text{ref}}$

solutal dispersion scale $|\mathsf{D}|\sim D_{\text{ref}}$

thermal dispersion scale $|\mathsf{G}|\sim G_{\text{ref}}$

solutal reaction scale $R\sim \Delta R$

thermal reaction scale $Q\sim \Delta Q$

pressure scale $p\sim\mu_{\text{ref}}\,\mathcal{U}\mathcal{L}/K_{\text{ref}}$

streamfunction scale $\psi\sim \mathcal{U}\mathcal{L}$

domain length scale $\mathcal{L}_\Omega$

### Dimensionless numbers

Rayleigh number (defined with respect to the transport of $c$ and domain length scale)
$$Ra=\frac{\mathcal{L}_\Omega K_{\text{ref}}g\Delta\rho}{\mu_{\text{ref}}D_{\text{ref}}}=\underbrace{\frac{K_{\text{ref}}\,g\Delta\rho}{\mu_{\text{ref}}}}_{\text{convective speed}} \big/ \underbrace{\frac{D_{\text{ref}}}{\mathcal{L}_\Omega}}_{\text{diffusive speed}}$$

Damköhler number (defined with respect to the transport of $c$ and domain length scale)

$$Da=\frac{\mathcal{L}_\Omega \mu_{\text{ref}}\,\Delta R}{K_{\text{ref}}\,g\Delta\rho\Delta c} = \underbrace{\frac{\Delta R}{\Delta c}}_{\text{reaction rate}} \big/ \underbrace{\frac{K_{\text{ref}}\,g\Delta\rho}{\mathcal{L}_\Omega \mu_{\text{ref}}}}_{\text{convection rate}}$$

Lewis number for ratio of diffusivities
$$Le=\frac{G_{\text{ref}}}{D_{\text{ref}}}$$

Lewis number for ratio of reaction rates

$$Lr=\frac{\Delta Q\Delta c}{\Delta\theta \Delta R} = \underbrace{\frac{\Delta Q}{\Delta\theta}}_{\text{thermal reaction rate}} \big/ \underbrace{\frac{\Delta R}{\Delta c}}_{\text{solutal reaction rate}}$$

dimensionless domain length 
$$Xl=\frac{\mathcal{L}_\Omega}{\mathcal{L}}$$

### Non-dimensional equations

$$\phi\frac{\partial c}{\partial t}+Ad\,\textbf{u}\cdot\nabla c=\frac{1}{Pe}\nabla\cdot(\mathsf{D}\cdot\nabla c) + Ki R$$

$$\phi\frac{\partial\theta}{\partial t}+Ad\,\textbf{u}\cdot\nabla\theta=\frac{1}{LePe}\nabla\cdot(\mathsf{G}\cdot\nabla\theta) + LrKi Q$$

$$\nabla\cdot\textbf{u}=0$$

$$\textbf{u}=-\frac{\mathsf{K}}{\mu}\cdot\left(\nabla p - Bu \rho\,\textbf{e}_g\right)$$

$$Ad=\frac{\mathcal{U}\mathcal{T}}{\phi_{\text{ref}}\mathcal{L}}$$

$$Pe=\frac{\phi_{\text{ref}}\mathcal{L}^2}{D_{\text{ref}}\mathcal{T}}$$

$$Ki=\frac{\mathcal{T}\Delta R}{\phi_{\text{ref}}\Delta c}$$

$$Bu=\frac{K_{\text{ref}}\,g\Delta\rho}{\mu_{\text{ref}}\,\mathcal{U}}$$


### Some common choices 

A particular choice of non-dimensionalization with $\mathcal{L}$, $\mathcal{U}$ and $\mathcal{T}$ chosen according to the details of the problem (e.g. boundary conditions, dominant transport processes) will map $\{Ad, Pe, Ki, Bu, Xl\}$ onto combinations of the Rayleigh, Damköhler and Lewis numbers.

| $\mathcal{L}$ | $\mathcal{U}$ |$ \mathcal{T}$ | $\{Ad, Pe, Ki, Bu, Xl\}$ | Examples | 
| -------- | ------- | ------- | ------- | ------- |
| $\mathcal{L}_\Omega$  |  $K_{\text{ref}}\,g\Delta\rho/\mu_{\text{ref}}$  | $\phi_{\text{ref}}\mathcal{L}/\mathcal{U}$ | $\{1, Ra, Da, 1, 1\}$| [Hewitt et al. (2012)](https://link.aps.org/doi/10.1103/PhysRevLett.108.224503) |
| $D_{\text{ref}}/\mathcal{U}$  |  $K_{\text{ref}}\,g\Delta\rho/\mu_{\text{ref}}$  | $\phi_{\text{ref}}\mathcal{L}/\mathcal{U}$ | $\{1, 1, Da/Ra, 1, Ra\}$| [Slim (2014)](https://www.cambridge.org/core/product/identifier/S0022112013006733/type/journal_article) | 
| $\mathcal{L}_\Omega$  |  $D_{\text{ref}}/\mathcal{L}$  | $\phi_{\text{ref}}\mathcal{L}/\mathcal{U}$ | $\{1, 1, RaDa, Ra, 1\}$| [Ritchie \& Pritchard  (2011)](https://www.cambridge.org/core/journals/journal-of-fluid-mechanics/article/natural-convection-and-the-evolution-of-a-reactive-porous-medium/71E5FB557F61CB9125E5B4E4EE9D828F) | 
| $\sqrt{D_{\text{ref}}\mathcal{T}/\phi_{\text{ref}}}$  |  $\phi_{\text{ref}}\mathcal{L}/\mathcal{T}$  | $\phi_{\text{ref}}\Delta c/\Delta R$  | $\{1, 1, 1, \sqrt{Ra/Da}, \sqrt{RaDa}\}$| [Kabbadj et al. (2025)](https://nlpc.ulb.be/pdf/25.Kabbadj_MATRIX.pdf) | 


<!-- ## Discretization

### $d=2$ Cartesian streamfunction formulation

$$\textbf{u} =-\frac{\partial\psi}{\partial y}\textbf{e}_x + \frac{\partial\psi}{\partial x}\textbf{e}_y$$

$$\textbf{e}_g = e_{g}^{x}\,\textbf{e}_x + e_{g}^{y}\,\textbf{e}_y$$

$$\nabla\cdot\left(\frac{\mu\mathsf{K}^{\mathsf{T}}\cdot\nabla\psi}{\text{det}(\mathsf{K})}\right)=-\frac{\partial(e_{g}^{y}\rho g)}{\partial x} + \frac{\partial(e_{g}^{x}\rho g)}{\partial y}$$

### Discretization in time

$$\Delta t^n = \min(\Delta t_{\text{max}}, \Delta t_{\text{CFL}}(\textbf{u}^n))$$

$$\phi^n\frac{c^{n+1}-c^n}{\Delta t^n} + \mathcal{D}_{\textbf{u}, c}(\textbf{u}\cdot\nabla c) = \nabla\cdot(\mathsf{D}^n\cdot\nabla\mathcal{D}_{\mathsf{D}}(c)) + \mathcal{D}_R(R)$$

$$\phi^n\frac{\theta^{n+1}-\theta^n}{\Delta t^n} + \mathcal{D}_{\textbf{u}, \theta}(\textbf{u}\cdot\nabla \theta) = \nabla\cdot(\mathsf{G}^n\cdot\nabla\mathcal{D}_{\mathsf{G}}(\theta)) + \mathcal{D}_Q(Q)$$

$$\textbf{u}^n =-\frac{\partial\psi^n}{\partial y}\textbf{e}_x + \frac{\partial\psi^n}{\partial x}\textbf{e}_y$$

$$\nabla\cdot\left(\frac{\mu^n(\mathsf{K}^n)^{\mathsf{T}}\cdot\nabla\psi^n}{\text{det}(\mathsf{K}^n)}\right)=-\frac{\partial(e_{g}^{y}\rho^n)}{\partial x} + \frac{\partial(e_{g}^{x}\rho^n)}{\partial y}$$

### Discretization in space

... -->